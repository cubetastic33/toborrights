function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},r=t.parcelRequire94c2;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},t.parcelRequire94c2=r);var i=r("7JJcr"),s=r("gOFYb");const d=i.createClient("https://gwcnruxqmtukvguyhuga.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3Y25ydXhxbXR1a3ZndXlodWdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDk5MjI5MTIsImV4cCI6MTk2NTQ5ODkxMn0.Cpm-Myt5YdzFrRzYcWWaFxVDiyQWeJCD3dTZBvRlcp4"),o=e(s)("#toast"),l=e(s)("#status"),c=e(s)("#signed-out"),u=e(s)("#restaurants"),h=e(s)("#order-details"),m=e(s)("#sign-in"),p=e(s)("#my-orders"),f=e(s)("#order-list");function g(e,t=2e3){o.text(e).show(),setTimeout((()=>o.addClass("slide-down")),t),setTimeout((()=>o.removeClass("slide-down").hide()),t+500)}function b(){let t=d.auth.user();null===t?(l.hide(),c.show(),h.hide(),p.hide(),u.show().removeClass("fade")):(c.hide(),e(s)(".netid").text(t.email.slice(0,-13).toUpperCase()),l.show(),v())}function v(){d.from("orders").select("id, time_slot, restaurants (name), delivery_location, description, fulfilled, phone, donation").filter("cancelled","eq","false").order("created_at",{ascending:!1}).then((t=>{if(t.error&&g(t.error.message,5e3),0!==t.data.length){p.show(),f.empty();for(let a=0;a<t.data.length;a++){let n=e(s)(`<div class="order">\n                    <b>Timeslot:</b> ${t.data[a].time_slot}<br>\n                    <b>Restaurant:</b> ${t.data[a].restaurants.name}<br>\n                    <div class="desc"><b>Description:</b> ${t.data[a].description}</div><br>\n                    <b>Delivery Location:</b> ${t.data[a].delivery_location}<br>\n                    <b>Donation:</b> ${t.data[a].donation}\n                </div>`);t.data[a].phone&&n.append(`<b>Phone:</b> ${t.data[a].phone}`),t.data[a].fulfilled?n.append('<span class="top-right">Fulfilled</span>'):n.append(`<span class="top-right">\n                        <button class="text cancel" data-id="${t.data[a].id}">cancel</button>\n                    </span>`),f.append(n)}e(s)(".cancel").off().on("click",(function(){d.from("orders").update({cancelled:!0}).match({id:e(s)(this).data("id")}).then((e=>{e.error?g(e.error.message):g("Cancelled order")}))}))}else p.hide()}),(e=>g(e,5e3)))}b(),d.auth.onAuthStateChange(b),d.from("orders").on("*",(e=>{console.log("Change received!",e),v()})).subscribe(),e(s)("#sign-out").on("click",(()=>d.auth.signOut().then((e=>{g("Signed out successfully")})).catch((e=>g(e.response.text))))),d.from("restaurants").select().then((t=>{if(t.error)g(t.error.message,5e3);else if(0===t.data.length)g("No restaurants were found",5e3);else{for(let e=0;e<t.data.length;e++){const{error:a,publicURL:n}=d.storage.from("restaurant-images").getPublicUrl(t.data[e].image);if(a)return void g(a.message,5e3);let r=t.data[e].id,i=t.data[e].name,s=t.data[e].menu;u.append(`<div class="restaurant"\n                    data-id="${r}" data-name="${i}" data-menu="${s}"\n                    style="background-image: url('${n}')">\n                        <h1>${i}</h1>\n                    </div>`)}e(s)(".restaurant").on("click",(function(){let t=e(s)(this).data("name");"undefined"!=typeof pa&&pa.track({name:t}),u.addClass("fade"),setTimeout((()=>{u.hide(),d.auth.user()?(h.data("id",e(s)(this).data("id")).show(),e(s)(this).data("menu")?(e(s)("#order-details .menu a").attr("href",e(s)(this).data("menu")),e(s)("#order-details .menu span").css("display","inline")):e(s)("#order-details .menu span").hide(),e(s)("#order-details .name").text(t)):m.show()}),100)}))}}),(e=>g(e,5e3))),m.on("submit",(t=>{t.preventDefault();const a=e(s)("#netid").val()+"@utdallas.edu";d.auth.signIn({email:a}).then((t=>{t.error?g(t.error.message,5e3):e(s)("body").html(`<div id="check-email">Check ${a} for a magic link to login</div>`)})).catch((e=>g(e.response.text)))})),e(s)(".back").on("click",(()=>{m.hide(),h.hide(),u.show().removeClass("fade")})),h.on("submit",(t=>{t.preventDefault();const a=e(s)("#phone").val(),n=e(s)("#identifier").val();d.from("orders").insert({time_slot:e(s)("#time-slot").val(),customer:d.auth.user().id,restaurant:h.data("id"),delivery_location:e(s)("#location").val(),description:e(s)("#description").val(),identifier:n.length?n:null,phone:a.length?a:null,donation:e(s)("#donation").val()}).then((t=>{t.error?g(t.error.message,5e3):(g("Order placed successfully!"),e(s)("form").trigger("reset"),h.hide(),u.show().removeClass("fade"))}),(e=>g(e,5e3)))}));
//# sourceMappingURL=index.52dd9f2a.js.map
