{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,sBAIA,MAAMC,EAAWF,EAAAG,aAAa,2CAA4C,oNAEpEC,EAASC,EAAAC,EAAA,CAAE,UACXC,EAAaF,EAAAC,EAAA,CAAE,cAErB,SAASE,EAAWC,EAAiBC,EAAmB,KACpDN,EAAOO,KAAKF,GAASG,OAErBC,YAAW,IAAMT,EAAOU,SAAS,eAAeJ,GAChDG,YAAW,IAAMT,EAAOW,YAAY,cAAcC,QAAQN,EAAW,KAGzE,SAASO,IACL,IAAIC,EAAOhB,EAASiB,KAAKD,OACZ,OAATA,GAMJX,EAAWK,OACXP,EAAAC,EAAA,CAAE,UAAUK,KAAKO,EAAKE,MAAMC,MAAM,GAAG,IAAKC,gBALtCf,EAAWS,OAQnBC,IAEAf,EAASiB,KAAKI,mBAAkB,CAACC,EAAOC,KAItB,cAAVD,GAAuD,UAA9BjB,EAAWmB,IAAI,aACxCC,SAASC,KAAO,cACpBX,OAGJZ,EAAAC,EAAA,CAAE,QAAQuB,GAAG,UAAUC,IACnBA,EAAEC,iBAEF,MAAMX,EAAgBf,EAAAC,EAAA,CAAE,UAAU0B,MAAQ,gBAC1C9B,EAASiB,KAAKc,OAAO,CA3CzBb,MA2C2BA,IAClBc,MAAKC,IACEA,EAASC,MACT5B,EAAW2B,EAASC,MAAM3B,QAAS,KAEnCJ,EAAAC,EAAA,CAAE,QAAQ+B,KAAK,+BAA+BjB,wCAGrDkB,OAAMC,GAAO/B,EAAW+B,EAAIJ,SAASxB","sources":["scripts/signin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\nimport $ from \"cash-dom\";\n\n// Create a single supabase client for interacting with your database\nconst supabase = createClient(\"https://gwcnruxqmtukvguyhuga.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3Y25ydXhxbXR1a3ZndXlodWdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDk5MjI5MTIsImV4cCI6MTk2NTQ5ODkxMn0.Cpm-Myt5YdzFrRzYcWWaFxVDiyQWeJCD3dTZBvRlcp4\");\n\nconst $toast = $(\"#toast\");\nconst $signed_in = $(\".signed-in\");\n\nfunction show_toast(message: string, duration: number = 2000) {\n    $toast.text(message).show();\n    // After duration, slide the toast out of view\n    setTimeout(() => $toast.addClass(\"slide-down\"), duration);\n    setTimeout(() => $toast.removeClass(\"slide-down\").hide(), duration + 500);\n}\n\nfunction update_dom() {\n    let user = supabase.auth.user();\n    if (user === null) {\n        // If the user is signed out\n        $signed_in.hide();\n        return;\n    }\n    // If the user is signed in\n    $signed_in.show();\n    $(\".netid\").text(user.email.slice(0, -13).toUpperCase());\n}\n\nupdate_dom();\n\nsupabase.auth.onAuthStateChange((event, session) => {\n    // If the user was already signed in, $signed_in will already be visible\n    // If they were signed out, and just signed in through the magic link, then it would be hidden\n    // In that case, redirect them to the order page\n    if (event === \"SIGNED_IN\" && $signed_in.css(\"display\") !== \"block\")\n        location.href = \"order.html\";\n    update_dom();\n});\n\n$(\"form\").on(\"submit\", e => {\n    e.preventDefault();\n    // Sign the user in\n    const email: string = $(\"#netid\").val() + \"@utdallas.edu\";\n    supabase.auth.signIn({ email })\n        .then(response => {\n            if (response.error) {\n                show_toast(response.error.message, 5000);\n            } else {\n                $(\"body\").html(`<div id=\"check-email\">Check ${email} for a magic link to login</div>`);\n            }\n        })\n        .catch(err => show_toast(err.response.text));\n});\n"],"names":["$7JJcr","parcelRequire","$c1cd2a518caf3bfb$var$supabase","createClient","$c1cd2a518caf3bfb$var$$toast","$parcel$interopDefault","$gOFYb","$c1cd2a518caf3bfb$var$$signed_in","$c1cd2a518caf3bfb$var$show_toast","message","duration","text","show","setTimeout","addClass","removeClass","hide","$c1cd2a518caf3bfb$var$update_dom","user","auth","email","slice","toUpperCase","onAuthStateChange","event","session","css","location","href","on","e","preventDefault","val","signIn","then","response","error","html","catch","err"],"version":3,"file":"index.0121238d.js.map"}