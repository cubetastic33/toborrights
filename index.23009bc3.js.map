{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,sBAIMC,EAAWF,EAAAG,aAAa,2CAA4C,oNAEpEC,EAASC,EAAAC,EAAA,CAAE,UACXC,EAAaF,EAAAC,EAAA,CAAE,cAErB,SAASE,EAAWC,OAAiBC,EAAAC,UAAAC,OAAA,QAAA,IAAAD,UAAA,GAAuBA,UAAA,GAAJ,IACpDP,EAAOS,KAAKJ,GAASK,OAErBC,YAAW,kBAAMX,EAAOY,SAAS,gBAAeN,GAChDK,YAAW,kBAAMX,EAAOa,YAAY,cAAcC,SAAQR,EAAW,KAGzE,SAASS,IACL,IAAIC,EAAOlB,EAASmB,KAAKD,OACZ,OAATA,GAMJb,EAAWO,OACXT,EAAAC,EAAA,CAAE,UAAUO,KAAKO,EAAKE,MAAMC,MAAM,GAAG,IAAKC,gBALtCjB,EAAWW,OAQnBC,IAEAjB,EAASmB,KAAKI,mBAAkB,SAACC,EAAOC,GAItB,cAAVD,GAAuD,UAA9BnB,EAAWqB,IAAI,aACxCC,SAASC,KAAO,eACpBX,OAGJd,EAAAC,EAAA,CAAE,QAAQyB,GAAG,UAAU,SAAAC,GACnBA,EAAEC,iBAEF,IAAMX,EAAgBjB,EAAAC,EAAA,CAAE,UAAU4B,MAAQ,gBAC1ChC,EAASmB,KAAKc,OAAO,CAAEb,MAAAA,IAClBc,MAAK,SAAAC,GACEA,EAASC,MACT9B,EAAW6B,EAASC,MAAM7B,QAAS,KAEnCJ,EAAAC,EAAA,CAAE,QAAQiC,KAAM,+BAAoCC,OAANlB,EAAM,wCAG3DmB,OAAM,SAAAC,UAAOlC,EAAWkC,EAAIL,SAASxB","sources":["scripts/signin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\nimport $ from \"cash-dom\";\n\n// Create a single supabase client for interacting with your database\nconst supabase = createClient(\"https://gwcnruxqmtukvguyhuga.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3Y25ydXhxbXR1a3ZndXlodWdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDk5MjI5MTIsImV4cCI6MTk2NTQ5ODkxMn0.Cpm-Myt5YdzFrRzYcWWaFxVDiyQWeJCD3dTZBvRlcp4\");\n\nconst $toast = $(\"#toast\");\nconst $signed_in = $(\".signed-in\");\n\nfunction show_toast(message: string, duration: number = 2000) {\n    $toast.text(message).show();\n    // After duration, slide the toast out of view\n    setTimeout(() => $toast.addClass(\"slide-down\"), duration);\n    setTimeout(() => $toast.removeClass(\"slide-down\").hide(), duration + 500);\n}\n\nfunction update_dom() {\n    let user = supabase.auth.user();\n    if (user === null) {\n        // If the user is signed out\n        $signed_in.hide();\n        return;\n    }\n    // If the user is signed in\n    $signed_in.show();\n    $(\".netid\").text(user.email.slice(0, -13).toUpperCase());\n}\n\nupdate_dom();\n\nsupabase.auth.onAuthStateChange((event, session) => {\n    // If the user was already signed in, $signed_in will already be visible\n    // If they were signed out, and just signed in through the magic link, then it would be hidden\n    // In that case, redirect them to the order page\n    if (event === \"SIGNED_IN\" && $signed_in.css(\"display\") !== \"block\")\n        location.href = \"/order.html\";\n    update_dom();\n});\n\n$(\"form\").on(\"submit\", e => {\n    e.preventDefault();\n    // Sign the user in\n    const email: string = $(\"#netid\").val() + \"@utdallas.edu\";\n    supabase.auth.signIn({ email })\n        .then(response => {\n            if (response.error) {\n                show_toast(response.error.message, 5000);\n            } else {\n                $(\"body\").html(`<div id=\"check-email\">Check ${email} for a magic link to login</div>`);\n            }\n        })\n        .catch(err => show_toast(err.response.text));\n});\n"],"names":["$buE07","parcelRequire","$e2455593973c2f84$var$supabase","createClient","$e2455593973c2f84$var$$toast","$parcel$interopDefault","$acYek","$e2455593973c2f84$var$$signed_in","$e2455593973c2f84$var$show_toast","message","duration","arguments","length","text","show","setTimeout","addClass","removeClass","hide","$e2455593973c2f84$var$update_dom","user","auth","email","slice","toUpperCase","onAuthStateChange","event","session","css","location","href","on","e","preventDefault","val","signIn","then","response","error","html","concat","catch","err"],"version":3,"file":"index.23009bc3.js.map"}